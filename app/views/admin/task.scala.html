@import org.maproulette.session.User
@import org.maproulette.actions.Actions
@(user:User, projectId:Long, parentType:String, parentId:Long)(implicit messages: Messages)

@views.html.admin.common.header("Administration", null,
    Map(
      "Projects" -> ("fa fa-folder", routes.Application.adminUIProjectList()),
      "Challenges" -> ("", routes.Application.adminUIChildList(Actions.ITEM_TYPE_CHALLENGE_NAME, projectId))
    )
)
<section class="content">
  <div class="box">
    <div class="box-header">
      <h3 class="box-title">Tasks</h3>
      <div class="pull-right">
        <a href="@routes.FormEditController.taskFormUI(projectId, parentId, parentType, -1)">
          <button class="btn-xs btn-block btn-primary">New Task</button>
        </a>
      </div>
    </div><!-- /.box-header -->
    <div class="box-body">
      <table id="projectTable" class="table table-bordered table-hover">
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Instruction</th>
            <th>Location</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
        </tbody>
        <tfoot>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Instruction</th>
            <th>Location</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </tfoot>
      </table>
    </div><!-- /.box-body -->
  </div><!-- /.box -->
</section>
<script>
        $(function() {
          $("#projectTable").DataTable({
            processing: true,
            serverSide: true,
            ajax: {
              url: "/ui/admin/datatable/@{parentType}/tasks/@{parentId}",
              type: "POST"
            },
            columns: [
              {
                data: "id",
                name: "id",
                title: "ID"
              },
              {
                data: "name",
                name: "name",
                title: "Name"
              },
              {
                orderable: false,
                data: "instruction",
                name: "instruction",
                title: "Instruction"
              },
              {
                orderable: false,
                data: "location",
                name: "location",
                title: "Location"
              },
              {
                data: "status",
                name: "status",
                title: "Status"
              },
              {
                orderable: false,
                data: "actions",
                name: "actions",
                title: "Actions",
                render: function ( data, type, full, meta ) {
                  var editHref = '/ui/admin/form/@projectId/@parentType/@parentId/task/';
                  var viewHref = '/map/@parentId/'
                  return '<div class="pull-left">' +
                            '<a href="' + editHref + data + '">' +
                              '<button class="btn-xs btn-block btn-warning">Edit</button>' +
                            '</a>' +
                          '</div>' +
                          '<div class="pull-left">' +
                            '<a href="' + viewHref + data + '?debug=true">' +
                              '<button class="btn-xs btn-block btn-success">View</button>' +
                            '</a>' +
                          '</div>' +
                          '<div class="pull-left">' +
                            '<button class="btn-xs btn-block btn-danger" onclick="javascript:deleteTask(' + data + ');">Delete</button>' +
                          '</div>';
                }
              }
            ]
          });
        });
</script>
